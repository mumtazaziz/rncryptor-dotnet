namespace RNCryptor.Tests;

internal class Vectors
{
    public static readonly PasswordVector[] Password = new PasswordVector[] {
        new PasswordVector(
            Title: "Multi-block",
            Version: FormatVersion.V2,
            Password: "password",
            EncryptionSalt: Convert.FromHexString("97076DC661B6E0CE"),
            HMACSalt: Convert.FromHexString("9DA3BB43D95BCD45"),
            IV: Convert.FromHexString("EE396D39E342FFDB679B270DCD9C557C"),
            Plaintext: Convert.FromHexString("546869732069732061206C6F6E676572207465737420766563746F7220696E74656E64656420746F206265206C6F6E676572207468616E206F6E6520626C6F636B2E"),
            Ciphertext: Convert.FromHexString("020197076DC661B6E0CE9DA3BB43D95BCD45EE396D39E342FFDB679B270DCD9C557C37055FFFCC1B663B1E6B8C5694DBB96D97A3AC0FA3F355DB6668C5A8A2A06F10056CE92384A618A35BF0FA9EB612B0B4FA72F749F76E2F728C16574DC2F15B7CEC1786D291C2135F932DDC5A34D9EAFD6B45F99491AC23C34299AF0BE68A43E6E8113BB748FBC19BCAD638EA79B07309")
        ),
        new PasswordVector(
            Title: "All fields empty or zero (with one-byte password)",
            Version: FormatVersion.V3,
            Password: "a",
            EncryptionSalt: Convert.FromHexString("0000000000000000"),
            HMACSalt: Convert.FromHexString("0000000000000000"),
            IV: Convert.FromHexString("00000000000000000000000000000000"),
            Plaintext: Convert.FromHexString(""),
            Ciphertext: Convert.FromHexString("03010000000000000000000000000000000000000000000000000000000000000000B3039BE31CD7ECE5E754F5C8DA17003666313AE8A89DDCF8E3CB41FDC130B2329DBE07D6F4D32C34E050C8BD7E933B12")
        ),
        new PasswordVector(
            Title: "One byte",
            Version: FormatVersion.V3,
            Password: "thepassword",
            EncryptionSalt: Convert.FromHexString("0001020304050607"),
            HMACSalt: Convert.FromHexString("0102030405060708"),
            IV: Convert.FromHexString("02030405060708090A0B0C0D0E0F0001"),
            Plaintext: Convert.FromHexString("01"),
            Ciphertext: Convert.FromHexString("03010001020304050607010203040506070802030405060708090A0B0C0D0E0F0001A1F8730E0BF480EB7B70F690ABF21E029514164AD3C474A51B30C7EAA1CA545B7DE3DE5B010ACBAD0A9A13857DF696A8")
        ),
        new PasswordVector(
            Title: "Exactly one block",
            Version: FormatVersion.V3,
            Password: "thepassword",
            EncryptionSalt: Convert.FromHexString("0102030405060700"),
            HMACSalt: Convert.FromHexString("0203040506070801"),
            IV: Convert.FromHexString("030405060708090A0B0C0D0E0F000102"),
            Plaintext: Convert.FromHexString("0123456789ABCDEF"),
            Ciphertext: Convert.FromHexString("030101020304050607000203040506070801030405060708090A0B0C0D0E0F0001020E437FE809309C03FD53A475131E9A1978B8EAEF576F60ADB8CE2320849BA32D742900438BA897D22210C76C35C849DF")
        ),
        new PasswordVector(
            Title: "More than one block",
            Version: FormatVersion.V3,
            Password: "thepassword",
            EncryptionSalt: Convert.FromHexString("0203040506070001"),
            HMACSalt: Convert.FromHexString("0304050607080102"),
            IV: Convert.FromHexString("0405060708090A0B0C0D0E0F00010203"),
            Plaintext: Convert.FromHexString("0123456789ABCDEF01234567"),
            Ciphertext: Convert.FromHexString("0301020304050607000103040506070801020405060708090A0B0C0D0E0F00010203E01BBDA5DF2CA8ADACE38F6C588D291E03F951B78D3417BC2816581DC6B767F1A2E57597512B18E1638F21235FA5928C")
        ),
        new PasswordVector(
            Title: "Multibyte password",
            Version: FormatVersion.V3,
            Password: "中文密码",
            EncryptionSalt: Convert.FromHexString("0304050607000102"),
            HMACSalt: Convert.FromHexString("0405060708010203"),
            IV: Convert.FromHexString("05060708090A0B0C0D0E0F0001020304"),
            Plaintext: Convert.FromHexString("23456789ABCDEF0123456701"),
            Ciphertext: Convert.FromHexString("03010304050607000102040506070801020305060708090A0B0C0D0E0F00010203048A9E08BDEC1C4BFE13E81FB85F009AB3DDB91387E809C4AD86D9E8A6014557716657BD317D4BB6A7644615B3DE402341")
        ),
        new PasswordVector(
            Title: "Longer text and password",
            Version: FormatVersion.V3,
            Password: "It was the best of times, it was the worst of times; it was the age of wisdom, it was the age of foolishness;",
            EncryptionSalt: Convert.FromHexString("0405060700010203"),
            HMACSalt: Convert.FromHexString("0506070801020304"),
            IV: Convert.FromHexString("060708090A0B0C0D0E0F000102030405"),
            Plaintext: Convert.FromHexString("697420776173207468652065706F6368206F662062656C6965662C20697420776173207468652065706F6368206F6620696E63726564756C6974793B206974207761732074686520736561736F6E206F66204C696768742C206974207761732074686520736561736F6E206F66204461726B6E6573733B206974207761732074686520737072696E67206F6620686F70652C20697420776173207468652077696E746572206F6620646573706169723B207765206861642065766572797468696E67206265666F72652075732C20776520686164206E6F7468696E67206265666F72652075733B207765207765726520616C6C20676F696E67206469726563746C7920746F2048656176656E2C207765207765726520616C6C20676F696E6720746865206F74686572207761792E0A0A"),
            Ciphertext: Convert.FromHexString("030104050607000102030506070801020304060708090A0B0C0D0E0F000102030405D564C7A99DA921A6E7C4078A82641D95479551283167A2C81F31AB80C9D7D8BEB770111DECD3E3D29BBDF7EBBFC5F10AC87E7E55BFB5A7F487BCD39835705E83B9C049C6D6952BE011F8DDB1A14FC0C925738DE017E62B1D621CCDB75F2937D0A1A70E44D843B9C61037DEE2998B2BBD740B910232EEA71961168838F6995B9964173B34C0BCD311A2C87E271630928BAE301A8F4703AC2AE4699F3C285ABF1C55AC324B073A958AE52EE8C3BD68F919C09EB1CD28142A1996A9E6CBFF5F4F4E1DBA07D29FF66860DB9895A48233140CA249419D63046448DB1B0F4252A6E4EDB947FD0071D1E52BC15600622FA548A6773963618150797A8A80E592446DF5926D0BFD32B544B796F3359567394F77E7B171B2F9BC5F2CAF7A0FAC0DA7D04D6A86744D6E06D02FBE15D0F580A1D5BD16AD91348003611358DCB4AC9990955F6CBBBFB185941D4B4B71CE7F9BA6EFC1270B7808838B6C7B7EF17E8DB919B34FAC")
        )
    };
}


internal readonly record struct KdfVector(
    string Title,
    int Version,
    byte[] Password,
    byte[] Salt,
    byte[] Key
);

internal readonly record struct KeyVector(
    string Title,
    int Version,
    byte[] EncryptionKey,
    byte[] HMACKey,
    byte[] IV,
    byte[] Plaintext,
    byte[] Ciphertext
);

internal readonly record struct PasswordVector(
    string Title,
    FormatVersion Version,
    string Password,
    byte[] EncryptionSalt,
    byte[] HMACSalt,
    byte[] IV,
    byte[] Plaintext,
    byte[] Ciphertext
);
